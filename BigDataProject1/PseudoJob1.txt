Class ProductEntry
	- name 	:String;
	- sum	:Integer;
	
	getters e setters...


map(key, row)
	foreach entry in row
		month = getMonth(row)
		products = splitProducts(entry)
		foreach product in products
			Emit(month, new ProductEntry(product, 1))


reduce(month, productEntries[])
	//la chiave della mappa corrisponde al valore del campo
	//name dell'oggetto ProductEntry
	map = initMap() //key: productName; value: ProducyEntry object;
	foreach entry in productEntries
		productSum = map.get(entry.getName())
		
		if (productSum == NIL)
			productSum = new ProductEntry()
			map.push(entry.getName(), productSum)
		
		oldSum = productCount.getSum()
		newSum = oldSum + entry.getCount()
		
		productSum.setSum(newSum)
		//inutile, perché già c'è la mappa referenzia al productSum aggiornato
		//map.push(entry.getName(), productSum)

	sumProductEntries = map.getArray()
	sumProductEntries.sort(compareBySum) //Comparatore per sum come parametro
	
	sumProductEntries.filter(5) //filtra i primi 5 prodotti più venduti

	Emit(month, sumProductEntries)